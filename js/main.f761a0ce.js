"use strict";(self.webpackChunkdodgy_slime=self.webpackChunkdodgy_slime||[]).push([[792],{833:()=>{const e=318,t=500,s={STRIPE:{COUNT:5,WIDTH:e/5}},i=(Math.floor(s.STRIPE.COUNT/2),s.STRIPE.WIDTH,s.STRIPE.WIDTH,20),o=23,a=48,r=48,n=24,h=24,m=24,c=24;Phaser.Input.Keyboard.KeyCodes.A,Phaser.Input.Keyboard.KeyCodes.D,Phaser.Input.Keyboard.KeyCodes.LEFT,Phaser.Input.Keyboard.KeyCodes.RIGHT,Phaser.Input.Keyboard.KeyCodes.W,Phaser.Input.Keyboard.KeyCodes.UP;var l,d,_,E,p,T,u,b,D,f,O,I,C,A,g;!function(e){e.IDLE="character_idle",e.WALK="character_walk",e.DASH="character_dash",e.DIE="character_die"}(l||(l={})),function(e){e[e.RIGHT=1]="RIGHT",e[e.UP=0]="UP",e[e.LEFT=-1]="LEFT"}(d||(d={})),function(e){e.IDLE="idle",e.WALK="walk",e.DASH="dash",e.ATTACK="attack",e.DEAD="dead"}(_||(_={})),function(e){e.GREEN="GREEN",e.PURPLE="PURPLE",e.ORANGE="ORANGE",e.RED="RED",e.BLACK="BLACK",e.BLUE="BLUE",e.BLUE_DUPLICANT="BLUE_DUPLICANT"}(E||(E={})),function(e){e.GREEN_MOVE="green_slime_move",e.GREEN_DIE="green_slime_die",e.PURPLE_MOVE="purple_slime_move",e.PURPLE_DIE="purple_slime_die",e.ORANGE_MOVE="orange_slime_move",e.ORANGE_SHOOT="orange_slime_shoot",e.ORANGE_DIE="orange_slime_die",e.ORANGE_PROJECTILE="orange_slime_projectile",e.RED_MOVE="red_slime_move",e.RED_DIE="red_slime_die",e.RED_ATTACK="red_slime_attack",e.BLACK_MOVE="black_slime_move",e.BLACK_DIE="black_slime_die",e.BLACK_HIDE="black_slime_hide",e.BLUE_MOVE="blue_slime_move",e.BLUE_DUPLICATE="blue_slime_duplicate",e.BLUE_DUPLICANT_MOVE="blue_slime_duplicant_move",e.BLUE_DUPLICANT_DIE="blue_slime_duplicant_die"}(p||(p={})),function(e){e[e.PLAYING=0]="PLAYING",e[e.PAUSED=1]="PAUSED",e[e.GAME_OVER=2]="GAME_OVER"}(T||(T={})),function(e){e.FULL="heart_full",e.HALF="heart_half",e.EMPTY="heart_empty"}(u||(u={})),function(e){e.IDLE="character_idle",e.WALK_RIGHT="character_walk_right",e.DASH_UP="character_dash_up",e.DASH_RIGHT="character_dash_right",e.DASH_DOWN="character_dash_down",e.DIE_RIGHT="character_die_right",e.DIE_UP="character_die_up"}(b||(b={})),function(e){e.MOVE_DOWN="green_slime_move_down",e.DIE_DOWN="greean_slime_die_down"}(D||(D={})),function(e){e.MOVE_DOWN="purple_slime_move_down",e.MOVE_RIGHT="purple_slime_move_right",e.DIE_DOWN="purple_slime_die_down",e.DIE_RIGHT="purple_slime_die_right"}(f||(f={})),function(e){e.MOVE_DOWN="orange_slime_move_down",e.SHOOT_DOWN="orange_slime_shoot_down",e.DIE_DOWN="orange_slime_die_down",e.PROJECTILE_HIT="orange_slime_projectile_hit"}(O||(O={})),function(e){e.MOVE_DOWN="red_slime_move_down",e.DIE_DOWN="red_slime_die_down",e.ATTACK="red_slime_attack"}(I||(I={})),function(e){e.MOVE_DOWN="black_slime_move_down",e.DIE_DOWN="black_slime_die_down",e.HIDE="black_slime_hide"}(C||(C={})),function(e){e.MOVE_DOWN="blue_slime_move_down",e.DUPLICATE="blue_slime_duplicate"}(A||(A={})),function(e){e.MOVE_DOWN="blue_slime_duplicant_move_down",e.MOVE_RIGHT="blue_slime_duplicant_move_right",e.DIE_DOWN="blue_slime_duplicant_die_down"}(g||(g={}));class y{static createAnimationFromConfig(e,t){e.anims.create({key:t.key,frames:e.anims.generateFrameNumbers(t.texture,{start:t.start,end:t.end}),frameRate:t.frameRate,repeat:t.repeat,yoyo:null==t?void 0:t.yoyo})}}class L extends y{static createCharacterAnimations(e){this.created||(this.ANIMATION_CONFIGS.forEach((t=>{this.createAnimationFromConfig(e,t)})),this.created=!0)}static reset(){this.created=!1}}L.created=!1,L.ANIMATION_CONFIGS=[{key:b.IDLE,texture:l.IDLE,start:0,end:7,frameRate:10,repeat:-1},{key:b.WALK_RIGHT,texture:l.WALK,start:0,end:3,frameRate:15,repeat:0},{key:b.DASH_RIGHT,texture:l.DASH,start:0,end:3,frameRate:15,repeat:0},{key:b.DASH_UP,texture:l.DASH,start:4,end:7,frameRate:15,repeat:0},{key:b.DASH_DOWN,texture:l.DASH,start:8,end:11,frameRate:15,repeat:0},{key:b.DIE_RIGHT,texture:l.DIE,start:4,end:7,frameRate:10,repeat:0},{key:b.DIE_UP,texture:l.DIE,start:0,end:3,frameRate:10,repeat:0}];class R extends y{static createSlimeAnimations(e,t){this.createdAnimations.has(t)||(this.ANIMATION_CONFIGS[t].forEach((t=>{this.createAnimationFromConfig(e,t)})),this.createdAnimations.add(t))}static reset(){this.createdAnimations.clear()}}R.ANIMATION_CONFIGS={[E.GREEN]:[{key:D.MOVE_DOWN,texture:p.GREEN_MOVE,start:0,end:3,frameRate:10,repeat:0,yoyo:!0},{key:D.DIE_DOWN,texture:p.GREEN_DIE,start:0,end:5,frameRate:10,repeat:0}],[E.PURPLE]:[{key:f.MOVE_DOWN,texture:p.PURPLE_MOVE,start:0,end:3,frameRate:10,repeat:-1,yoyo:!0},{key:f.MOVE_RIGHT,texture:p.PURPLE_MOVE,start:4,end:7,frameRate:10,repeat:0,yoyo:!0},{key:f.DIE_DOWN,texture:p.PURPLE_DIE,start:0,end:4,frameRate:10,repeat:0},{key:f.DIE_RIGHT,texture:p.PURPLE_DIE,start:5,end:9,frameRate:10,repeat:0}],[E.ORANGE]:[{key:O.PROJECTILE_HIT,texture:p.ORANGE_PROJECTILE,start:0,end:3,frameRate:10,repeat:0},{key:O.MOVE_DOWN,texture:p.ORANGE_MOVE,start:0,end:3,frameRate:10,repeat:-1,yoyo:!0},{key:O.DIE_DOWN,texture:p.ORANGE_DIE,start:0,end:5,frameRate:10,repeat:0},{key:O.SHOOT_DOWN,texture:p.ORANGE_SHOOT,start:0,end:5,frameRate:10,repeat:0}],[E.RED]:[{key:I.MOVE_DOWN,texture:p.RED_MOVE,start:0,end:3,frameRate:10,repeat:-1,yoyo:!0},{key:I.DIE_DOWN,texture:p.RED_DIE,start:0,end:5,frameRate:10,repeat:0},{key:I.ATTACK,texture:p.RED_ATTACK,start:0,end:6,frameRate:15,repeat:0,yoyo:!0}],[E.BLACK]:[{key:C.MOVE_DOWN,texture:p.BLACK_MOVE,start:0,end:3,frameRate:10,repeat:-1,yoyo:!0},{key:C.DIE_DOWN,texture:p.BLACK_DIE,start:0,end:5,frameRate:10,repeat:0},{key:C.HIDE,texture:p.BLACK_HIDE,start:0,end:5,frameRate:15,repeat:0}],[E.BLUE]:[{key:A.MOVE_DOWN,texture:p.BLUE_MOVE,start:0,end:3,frameRate:10,repeat:-1,yoyo:!0},{key:A.DUPLICATE,texture:p.BLUE_DUPLICATE,start:0,end:9,frameRate:10,repeat:0}],[E.BLUE_DUPLICANT]:[{key:g.MOVE_DOWN,texture:p.BLUE_DUPLICANT_MOVE,start:0,end:3,frameRate:10,repeat:-1,yoyo:!0},{key:g.MOVE_RIGHT,texture:p.BLUE_DUPLICANT_MOVE,start:4,end:7,frameRate:10,repeat:-1,yoyo:!0},{key:g.DIE_DOWN,texture:p.BLUE_DUPLICANT_DIE,start:0,end:7,frameRate:10,repeat:0}]},R.createdAnimations=new Set;class x{constructor(e){this.scene=e}loadFonts(){return this.scene.load.bitmapFont("EpilepsySans","assets/fonts/bitmap/EpilepsySans/EpilepsySans.png","assets/fonts/bitmap/EpilepsySans/EpilepsySans.fnt"),this.scene.load.bitmapFont("Monocraft","assets/fonts/bitmap/Monocraft/Monocraft.png","assets/fonts/bitmap/Monocraft/Monocraft.fnt"),this.scene.load.bitmapFont("TeenyTinyPixls","assets/fonts/bitmap/TeenyTinyPixls/TeenyTinyPixls.png","assets/fonts/bitmap/TeenyTinyPixls/TeenyTinyPixls.xml"),this}loadHUDAssets(){return this.scene.load.image("red-heart-full","assets/ui/hud/new-health-bar/red-heart-full.png"),this.scene.load.image("red-heart-half","assets/ui/hud/new-health-bar/red-heart-half.png"),this.scene.load.image("red-heart-empty","assets/ui/hud/new-health-bar/red-heart-empty.png"),this.scene.load.image("golden-heart-full","assets/ui/hud/new-health-bar/golden-heart-full.png"),this.scene.load.image("golden-heart-half","assets/ui/hud/new-health-bar/golden-heart-half.png"),this.scene.load.image("golden-heart-empty","assets/ui/hud/new-health-bar/golden-heart-empty.png"),this}loadCharacterAssets(){const e={frameWidth:i,frameHeight:o};return this.scene.load.spritesheet(l.IDLE,"assets/main-character/idle/idle.png",e),this.scene.load.spritesheet(l.WALK,"assets/main-character/walk/walk.png",e),this.scene.load.spritesheet(l.DASH,"assets/main-character/dash/dash.png",e),this.scene.load.spritesheet(l.DIE,"assets/main-character/die/die.png",Object.assign(Object.assign({},e),{frameHeight:30})),this}loadSlimeAssets(){const e={frameWidth:a,frameHeight:r},t={frameWidth:n,frameHeight:h},s={frameWidth:m,frameHeight:c};return this.scene.load.spritesheet(p.GREEN_MOVE,"assets/slimes/green_slime/move/move.png",e),this.scene.load.spritesheet(p.GREEN_DIE,"assets/slimes/green_slime/die/die.png",e),this.scene.load.spritesheet(p.PURPLE_MOVE,"assets/slimes/purple_slime/move/move.png",e),this.scene.load.spritesheet(p.PURPLE_DIE,"assets/slimes/purple_slime/die/die.png",e),this.scene.load.spritesheet(p.ORANGE_DIE,"assets/slimes/orange_slime/die/die.png",e),this.scene.load.spritesheet(p.ORANGE_MOVE,"assets/slimes/orange_slime/move/move.png",e),this.scene.load.spritesheet(p.ORANGE_SHOOT,"assets/slimes/orange_slime/shoot/shoot.png",e),this.scene.load.spritesheet(p.ORANGE_PROJECTILE,"assets/slimes/orange_slime/projectile.png",t),this.scene.load.spritesheet(p.RED_DIE,"assets/slimes/red_slime/die/die.png",e),this.scene.load.spritesheet(p.RED_MOVE,"assets/slimes/red_slime/move/move.png",e),this.scene.load.spritesheet(p.RED_ATTACK,"assets/slimes/red_slime/attack/attack.png",e),this.scene.load.spritesheet(p.BLACK_DIE,"assets/slimes/black_slime/die/die.png",e),this.scene.load.spritesheet(p.BLACK_MOVE,"assets/slimes/black_slime/move/move.png",e),this.scene.load.spritesheet(p.BLACK_HIDE,"assets/slimes/black_slime/hide/hide.png",e),this.scene.load.spritesheet(p.BLUE_DUPLICATE,"assets/slimes/blue_slime/duplicate/duplicate.png",e),this.scene.load.spritesheet(p.BLUE_MOVE,"assets/slimes/blue_slime/move/move.png",e),this.scene.load.spritesheet(p.BLUE_DUPLICANT_DIE,"assets/slimes/blue_slime/duplicant/die/die.png",s),this.scene.load.spritesheet(p.BLUE_DUPLICANT_MOVE,"assets/slimes/blue_slime/duplicant/move/move.png",s),this}}Phaser.Physics.Arcade.Sprite;var P,S;!function(e){e[e.RIGHT=1]="RIGHT",e[e.LEFT=-1]="LEFT",e[e.DOWN=0]="DOWN"}(P||(P={}));!function(e){e.SLIME_KILLED="slime_killed",e.CHARACTER_TOOK_DAMAGE="character_took_damage",e.SLIME_PASSED="slime_passed",e.PROJECTILE_CAUGHT="projectile_caught"}(S||(S={}));class N{constructor(e,t){this.score=0,this.combo=0,this.comboMultiplier=1,this.comboTimeout=null,this.scene=e,this.config=Object.assign({tookDamage:-50,slimePassed:-90,slimeKilled:100,projectileCaught:50,comboMultiplierStep:.2,comboTimeout:5e3},t),this.setupEventListeners()}setupEventListeners(){this.scene.events.on(S.SLIME_KILLED,this.onSlimeKilled,this),this.scene.events.on(S.CHARACTER_TOOK_DAMAGE,(()=>{this.onTookDamage(),this.onComboBreak()}),this),this.scene.events.on(S.SLIME_PASSED,(()=>{this.onSlimePassed(),this.onComboBreak()}),this),this.scene.events.on(S.PROJECTILE_CAUGHT,this.onProjectileCaught,this)}resetComboTimer(){this.comboTimeout&&this.comboTimeout.destroy(),this.comboTimeout=this.scene.time.delayedCall(this.config.comboTimeout,(()=>{this.combo>0&&(this.resetCombo(),this.scene.events.emit("combo_timeout"))}))}onSlimeKilled(){this.increaseCombo();const e=this.config.slimeKilled*this.comboMultiplier;this.addScore(e),this.resetComboTimer()}onTookDamage(){this.addScore(.1*-this.score)}onSlimePassed(){this.addScore(.3*-this.score)}onProjectileCaught(){this.addScore(this.config.projectileCaught)}onComboBreak(){this.resetCombo()}addScore(e){this.score+=Math.floor(e),this.scene.events.emit("score_updated",this.score)}increaseCombo(){this.combo++,this.comboMultiplier=1+this.combo*this.config.comboMultiplierStep,this.scene.events.emit("combo_updated",this.combo,this.comboMultiplier)}resetCombo(){this.combo>0&&(this.combo=0,this.comboMultiplier=1,this.comboTimeout&&(this.comboTimeout.destroy(),this.comboTimeout=null),this.scene.events.emit("combo_updated"),this.scene.events.emit("combo_reset"))}getCurrentScore(){return this.score}getCurrentCombo(){return this.combo}getCurrentMultiplier(){return this.comboMultiplier}destroy(){this.scene.events.off(S.SLIME_KILLED,this.onSlimeKilled,this),this.scene.events.off(S.CHARACTER_TOOK_DAMAGE,this.onComboBreak,this),this.scene.events.off(S.SLIME_PASSED,this.onComboBreak,this),this.scene.events.off(S.PROJECTILE_CAUGHT,this.onProjectileCaught,this),this.comboTimeout&&this.comboTimeout.destroy()}}class M{constructor(e,t){this.comboTimeLeft=0,this.lastScore=0,this.scoreTextWidth=0,this.comboTextWidth=0,this.scene=e,this.scoreSystem=t,this.container=e.add.container(20,20),this.scoreText=e.add.bitmapText(0,0,"TeenyTinyPixls","0",15).setTintFill(16777215).setOrigin(0,0),this.scoreTextWidth=this.scoreText.width,this.comboText=e.add.bitmapText(this.scoreTextWidth,2,"TeenyTinyPixls","",10).setTintFill(16763904).setOrigin(0,0),this.comboTextWidth=this.comboText.width,this.comboTimeLeftBar=e.add.graphics().setVisible(!1),this.comboTimeLeftText=e.add.bitmapText(this.scoreTextWidth/2,40,"TeenyTinyPixls","",10).setTintFill(16763904).setOrigin(.5,0).setVisible(!1),this.container.add([this.scoreText,this.comboText,this.comboTimeLeftBar,this.comboTimeLeftText])}updateScore(e){const t=e-this.lastScore;this.scoreText.setText(e.toString()),this.scoreTextWidth=this.scoreText.width,this.comboText.setX(this.scoreTextWidth+8),0!==t&&this.showScoreChange(t),this.lastScore=e}showScoreChange(e){const t=e>0?65280:16711680,s=e>0?"+":"",i="+"===s?this.scoreTextWidth+this.comboTextWidth/2+2:this.scoreTextWidth/2,o=this.scene.add.bitmapText(i,27,"TeenyTinyPixls",`${s}${e}`,10).setTintFill(t).setOrigin(.5);this.container.add(o),this.scene.tweens.add({targets:o,y:60,alpha:0,duration:1e3,ease:"Power1",onComplete:()=>{this.container.remove(o),o.destroy()}})}updateCombo(e,t){e>0?(this.comboText.setText(`x${e} (${t.toFixed(1)}x)`),this.showComboPopup(e),this.resetComboTimer()):(this.comboText.setText(""),this.hideComboTimer()),this.comboTextWidth=this.comboText.width}showComboPopup(e){const t=this.scene.add.bitmapText(this.scene.scale.width/2,100,"EpilepsySans",`COMBO x${e}!`,13).setTintFill(16777215).setOrigin(.5);this.scene.tweens.add({targets:t,y:150,scale:3,alpha:0,duration:800,onComplete:()=>t.destroy()})}resetComboTimer(){if(this.scoreSystem.getCurrentCombo()>0){const e=this.scoreSystem.config;this.comboTimeLeft=e.comboTimeout,this.comboTimeLeftBar.setVisible(!0),this.comboTimeLeftText.setVisible(!0),this.updateComboTimerDisplay()}}updateComboTimerDisplay(){const e=this.scoreSystem.config,t=this.comboTimeLeft/e.comboTimeout;this.comboTimeLeftBar.clear(),this.comboTimeLeftBar.fillStyle(6710886),this.comboTimeLeftBar.fillRect(0,25,this.scoreTextWidth,8),this.comboTimeLeftBar.fillStyle(this.getTimerColor(t)),this.comboTimeLeftBar.fillRect(0,25,this.scoreTextWidth*t,8),this.comboTimeLeftText.setX(this.scoreTextWidth/2),this.comboTimeLeftText.setText(`${(this.comboTimeLeft/1e3).toFixed(1)}`)}getTimerColor(e){return e>.6?65280:e>.3?16776960:16711680}hideComboTimer(){this.comboTimeLeftBar.setVisible(!1),this.comboTimeLeftText.setVisible(!1)}showComboBreak(){const e=this.scene.add.bitmapText(this.scene.scale.width/2,100,"EpilepsySans","COMBO BREAK!",26).setTintFill(16711680).setOrigin(.5);this.scene.tweens.add({targets:e,alpha:0,y:100,duration:800,onComplete:()=>e.destroy()}),this.hideComboTimer()}update(e){this.scoreSystem.getCurrentCombo()>0&&this.comboTimeLeft>0&&(this.comboTimeLeft-=e,this.comboTimeLeft=Math.max(0,this.comboTimeLeft),this.updateComboTimerDisplay())}}class k extends Phaser.Scene{constructor(){super("TestScoreScene")}preload(){new x(this).loadFonts()}create(){this.scoreSystem=new N(this,{slimeKilled:100,comboMultiplierStep:.2,comboTimeout:2e3}),this.scoreRenderer=new M(this,this.scoreSystem),this.events.on("score_updated",(e=>{this.scoreRenderer.updateScore(e)})),this.events.on("combo_updated",((e,t)=>{this.scoreRenderer.updateCombo(e,t)})),this.events.on("combo_reset",(()=>{this.scoreRenderer.showComboBreak()})),this.events.on("combo_timeout",(()=>{this.scoreRenderer.showComboBreak()})),this.createCompactControls()}createCompactControls(){const e={fontFamily:"Arial",fontSize:"14px",color:"#000000",backgroundColor:"#aaaaaa",padding:{x:8,y:4},fixedWidth:70,align:"center"},t=440;this.add.text(10,t,"1: Kill",e).setInteractive().on("pointerdown",(()=>this.emitSlimeKilled())),this.add.text(85,t,"2: DMG",e).setInteractive().on("pointerdown",(()=>this.emitCharacterDamage())),this.add.text(160,t,"3: Pass",e).setInteractive().on("pointerdown",(()=>this.emitSlimePassed())),this.add.text(235,t,"4: Catch",e).setInteractive().on("pointerdown",(()=>this.emitProjectileCaught())),this.add.text(160,480,"Press 1-4 keys",{fontFamily:"Arial",fontSize:"12px",color:"#aaaaaa"}).setOrigin(.5)}emitSlimeKilled(){this.events.emit(S.SLIME_KILLED),this.showEventEffect(100,200,65280)}emitCharacterDamage(){this.events.emit(S.CHARACTER_TOOK_DAMAGE),this.showEventEffect(160,250,16711680),this.cameras.main.shake(50,.005)}emitSlimePassed(){this.events.emit(S.SLIME_PASSED),this.showEventEffect(220,200,16776960)}emitProjectileCaught(){this.events.emit(S.PROJECTILE_CAUGHT),this.showEventEffect(160,150,43775)}showEventEffect(e,t,s){const i=this.add.circle(e,t,10,s).setAlpha(.7);this.tweens.add({targets:i,radius:30,alpha:0,duration:400,onComplete:()=>i.destroy()})}update(e,t){this.scoreRenderer.update(t)}}const v={type:Phaser.AUTO,scale:{mode:Phaser.Scale.FIT,parent:"game-container",width:e,height:t},scene:[k],pixelArt:!0,autoRound:!0,render:{antialias:!1},physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!1}},input:{touch:!0}};new Phaser.Game(v)}},e=>{var t;t=833,e(e.s=t)}]);
//# sourceMappingURL=main.f761a0ce.js.map